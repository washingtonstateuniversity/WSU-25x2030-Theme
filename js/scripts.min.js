!function(a){"use strict";var b=function(){return!!window.navigator.userAgent.match(/(iPad|iPhone|iPod)/gi)},c=function(){return!!window.navigator.userAgent.match(/(Android)/gi)},d=function(){var b,c=function(){return a(document).height()-a(window).height()},d=function(){return a(window).scrollTop()},e=c(),f=function(){a(window).width()>791&&(b=d()/e*100+"%",a(".progress").css({width:b}))};a(document).on("scroll",f),a(window).on("resize",function(){e=c(),f()})},e=function(){var b=25,c=b/a(window).height(),d=b/a(window).width();a("#top").on("mousemove",function(b){var e=b.pageX-a(window).width()/2,f=b.pageY-a(window).height()/2,g=-(d*e)-25,h=-(c*f)-50;a(".image").css("transform","matrix(1, 0, 0, 1, "+g+", "+h+")")})};window.Doormat.prototype.go_to=function(b){var c=document.querySelectorAll(".panel");if(!c[b-1])throw Error("Doormat: no panel available at that index!");var d=c[b-1].STARTING_POS;void 0!==d&&a("body,html").animate({scrollTop:d})};var f=function(){a(".site-menu, .spine-sitenav").on("click","a",function(b){b.preventDefault();var c=a(this).parent("li"),d=c.index()+2;drive_doormat.go_to(d),jQuery.ui.spine.prototype.toggle_mobile_nav()})},g=function(){window.addEventListener("scroll",function(){var b=a(".panel"),c=a(".site-menu li");a.each(b,function(b){a(this).hasClass("current")&&c.eq(b-1).addClass("dogeared").siblings().removeClass("dogeared")})})},h=function(){var b=a("#stories").find(".column");a(document).on("scroll",function(){a.each(b,function(b){var c,d=a(this),e=0;d.hasClass("speed-faster-one")?e=20:d.hasClass("speed-faster-two")?e=30:d.hasClass("speed-slower-one")?e=-20:d.hasClass("speed-slower-two")&&(e=-30),0!==e&&(c=-(a(window).scrollTop()-d.offset().top)/parseInt(e),a(this).css("transform","translateY("+c+"px)"))})})},i=function(){var b=a("#commentform"),c=b.attr("action"),d=a(".comment-processing"),e=a(".comment-success"),f="";b.submit(function(){return f=b.serialize(),d.html('<div class="processing-indicator"></div>'),a.ajax({type:"post",url:c,data:f,success:function(){d.html(""),e.show(),b.find("textarea, input:not([type=submit])").val("")}}),!1})},j=function(){a(".comment-list").on("click",".remainder-toggle",function(b){b.preventDefault();var c=a(this),d=c.siblings(".ellipsis"),e=c.siblings(".comment-remainder");c.hasClass("close")?(c.removeClass("close"),e.hide(),d.show(),c.text("» Show more")):(c.addClass("close"),d.hide(),e.show(),c.text("« Show less"))})},k=function(){a(".comment-nav").on("click","a",function(b){b.preventDefault();var c={action:"comment_navigation",url:a(this).attr("href"),nonce:comments.nonce};a.post(comments.ajax_url,c,function(b){var c=a.parseJSON(b);a(".comment-list").html(c.comments),a(".comment-nav").html(c.navigation)})})};a(document).ready(function(){b()||c()||(d(),e(),h(),g()),f(),i(),j(),k()})}(jQuery);